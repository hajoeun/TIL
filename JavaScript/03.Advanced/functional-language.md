#자바스크립트의 함수형 언어 특징
_from Secrets of the JavaScript Ninja_

## 1. 함수형 언어의 특징이 왜 중요한가?
1. 자바스크립트에서 함수가 1종 객체(first-class object)라는 말은
    - 리터럴로 생성될 수 있고
    - 변수, 배열 엘리먼트, 다른 객체의 프로퍼티에 할당될 수 있고
    - 함수의 인자로 전달될 수 있고
    - 함수의 결과 값으로 반환될 수 있고
    - 동적으로 생성된 프로퍼티를 가질 수 있다는 것이다.
2. 브라우저의 이벤트 루프를 **비동기적으로 호출할 수 있다.** 여기서 말하는 이벤트란
    - 브라우저 이벤트(페이지 로드를 완료했을 때나 페이지가 언로드 될 때 발생하는 이벤트 등)
    - 네트워크 이벤트(Ajax 요청에 대한 응답 이벤트 등)
    - 사용자 이벤트(마우스 클릭, 마우스 움직임 또는 키 눌림 등)
    - 타이머 이벤트(시간 제한이 만료되거나 주기적으로 발생하는 이벤트 등)를 일컫는다.
    - 이러한 브라우저 이벤트 루프는 단일 스레드에서 동작한다. 이벤트 큐(FIFO 목록)에 들어오는 이벤트는 큐에 들어온 순서대로 처리된다.
3. 콜백(callback) 개념
    - 어떤 프로그램이 실행되는 동안 다른 함수가 적절한 시점에서 '다시 호출'된다는 점에서 생겨난 개념


## 2. 함수 선언
- 함수 내에서 선언된 타입의 유효 범위는 대부분의 다른 언어와 다르다.
    - 함수 내에 선언된 변수의 유효 범위는 변수가 선언된 지점으로부터 함수의 끝까지다. 블록 안에서 변수를 선언하더라도 그 변수는 변수를 선언한 지점부터 함수 끝부분까지 유효하다.
    - 이름이 지정된 내부 함수는 함수 내의 모든 곳에서 유효하다. 심지어는 함수를 선언한 부분 앞쪽에서 함수를 참조하더라도 이는 유효하다. ([함수 호이스팅](http://til.wiki.dev/JavaScript/Function()#function_10-함수-호이스팅-function-hoistinghttp://til.wiki.dev/JavaScript/Function()#function_10-함수-호이스팅-function-hoisting))
- 함수의 매개변수 목록의 길이와 실제 전달된 인자 목록의 길이는 서로 다를 수 있다.
    - 할당되지 않은 매개변수는 undefined로 평가된다.
    - 추가 인자들은 매개변수와 연결되지 않는다.


## 3. 함수 호출
- 함수를 호출하면 암묵적으로 두 개의 매개변수가 전달된다.
    - arguments, 실제로 전달된 인자의 컬렉션이다. ([참고](http://til.wiki.dev/JavaScript/Function()#function_5-this와-argumentshttp://til.wiki.dev/JavaScript/Function()#function_5-this와-arguments))
    - this, 함수 콘텍스트 객체를 참조한다. ([참고](http://til.wiki.dev/JavaScript/this-keywordhttp://til.wiki.dev/JavaScript/this-keyword))
- 함수를 호출하는 방식은 여러 가지이고, 각 호출 매커니즘에 따라 함수 콘텍스트 값이 결정된다. ([참고](http://til.wiki.dev/JavaScript/Function()#function_6-함수의-정의와-호출http://til.wiki.dev/JavaScript/Function()#function_6-함수의-정의와-호출))
    - 단지 '함수로서 호출'되면 함수의 콘텍스트는 전역 객체(window)이다.
    - '메서드로 호출'되면 콘텍스트는 그 메서드를 소유한 객체이다.
    - '생성자로 호출'되면 콘텍스트는 새로 생성된 객체이다.
    - apply()나 call() 메서드를 통해 호출되면 콘텍스트는 어떤 객체든 원하는 것으로 지정할 수 있다.

- 콜백의 함수 콘텍스트를 강제로 지정하기
    - 명령형 프로그래밍과 함수형 프로그래밍의 차이점은 함수를 단지  명령 구문으로만 취급하지 않고 프로그램 빌딩 블록으로 여기는 것에 있다.
    - 순회 함수는 '현재' 요소를 콜백 함수에 매개변수로 전달할 뿐이지만, 가장 중요한 점은 현재 요소를 콜백의 함수 콘텍스트로 지정한다는 것이다.
    - forEach 함수를 통해 배열의 각 요소에 대해 콜백 함수를 호출하게 할 수 있다.
```javascript
function forEach(list,callback) {
    for (var n = 0; n < list.length; n++) {
        callback.call(list[n],n);
    }
}

var weapons = ['shuriken','katana','nunchucks'];

forEach( weapons, function(index) {
    console.log("My weapon is " + weapons[index]);
});
```


## 4. 함수의 활용
- 익명 함수를 이용해서 절차적인 구문으로 가득찬 커다란 함수 대신 작은 실행 단위의 함수를 만들 수 있다.
- 재귀 함수를 통해 다양한 방법으로 함수를 참조할 수 있다.
    - 이름을 이용한 참조
    - 객체의 프로퍼티 명을 통해 메서드를 참조
    - arguments의 callee 프로퍼티를 이용한 참조
- 함수는 프로퍼티를 가질 수 있고, 원하는 정보를 저장하는데 프로퍼티를 활용할 수 있다.
    - 나중에 참조하거나 호출하기 위해서 함수의 프로퍼티에 함수를 저장할 수 있다.
    - 함수의 프로퍼티를 활용해서 캐시를 만들 수 있다. (메모이제이션)
- 함수를 호출할 때 전달되는 콘텍스트(문맥)를 조절하는 방식으로 메서드를 속여, 메서드를 소유하지 않은 객체를 대상으로 메서드가 동작하게끔 할 수 있다. (`call()`. `apply()`) 이것은 특히 Array나 Math와 같이 자신이 가진 데이터를 대상으로 연산을 수행하는 객체가 지니고 있는 메서드를 활용하는데 유용하다.
- 함수는 전달되는 인자에 따라 다른 연산을 수행할 수 있다. (함수 오버로딩) 전달된 인자의 타입이나 수에 따라서 원하는 일을 하기 위해서 인자 목록을 검사할 수 있다.
- 객체가 함수의 인스턴스인지 여부를 확인하는 것은 typeof 연산자의 결과가 'function'인지를 확인하면 된다. 다만, 여기에는 크로스 브라우저 이슈가 존재한다.
- **인라인 함수의 이름은 해당 함수 내에서만 유효하다.**


## 5. [클로저](http://til.wiki.dev/JavaScript/scope-and-closure#scope-and-closure_3-클로저-closure)와 가까워지기
- 클로저란 무엇인가, 어떻게 동작하는가?
- 클로저를 사용해서 개발의 복잡도 줄이기
- 클로저를 이용한 성능 향상
- 클로저를 이용한 유효 범위 문제 해결하기


_from Functional JavaScript_
## 6. apply를 이용한 함수형 프로그래밍
- 함수를 매개변수로 받아 또 다른 함수를 반환하는 함수를 만들 수 있다.

```javascript
function splat(fun) {
  return function(array) { // 반환되는 함수
    return fun.apply(null, array); // 이 함수의 실행 결과가 반환된 함수에서 반환되는 결과 값이다. 이 함수는 배열을 매개변수로 전달한다.
  };
}

var addArrayElements = splat(function(x, y) { return x + y; }); // 실제로 동작하는 함수는 여기에 있다.

addArrayElements([1,3]); // 4를 반환한다.
```


## 7. 함수형 프로그래밍 시작하기
- 정의: "함수형 프로그래밍은 값을 추상화의 단위로 바꾸는 기능을 하며 결국 바뀐 값들로 소프트웨어 시스템이 만들어진다."
- 함수형 프로그래밍이 중요한 이유
    - 객체 지향에서는 문제를 '명사'나 객체의 집합으로 나누는 반면 함수형에서는 같은 문제를 '동사'나 함수의 그룹으로 나눈다.
    - 객체 지향 프로그래밍과 마찬가지로 함수형 프로그래밍에서도 여러 함수를 '붙이'거나 '조립'해서 고수준 동작을 만든다.
    - 함수형 부품으로 시스템을 만드는 방법 중에는 하나의 함수를 이용하거나 합성된 함수를 이용하여 값을 다른 값으로 '변환'하는 방법도 있다.
    - 객체 지향에서는 각 객체의 내부 값이 바뀌면서 전체 시스템의 상태가 바뀐다. 이에 따라 복잡도가 증가할 수 있다.
    - 함수형에서는 관찰할 수 있는 상태 변화를 최소화하려고 애쓴다. 따라서 기존의 데이터가 파괴되지 않고 전체 동작의 흐름을 추적하기 쉬워진다.
    - 함수형에서는 시스템을 만들 때 명령형을 이용하여 모듈성을 높일 수 있도록 가능한 한 명시적 상태 변화를 최소한으로 유지한다.
    - 어떤 시스템에서의 상태변화를 완전히 제거하는 것이 아니라 변이가 발생하는 지역을 가능한 최소화하는 것을 목표로 한다.
- 함수, 추상화 단위
    - "실행할 수 있고, 올바로 동작하며, 빨리 실행되도록 만들어라." 버틀러 램슨(Butler Lampson)이 제시한 아주 오래된 격언
    - "실행할 수 있게 한 다음, 올바로 동작하게 하고, 그 다음 빠르게 실행되도록 만들어라." 켄트 백(Kent Beck)이 테스트 주도 개발(TDD)에 제시한 내용
    - 함수로 추상화를 하면 원하는 기능을 손쉽게 바꿀 수 있다는 장점이 있다. 그리고 단지 함수를 대체함으로써 새로운 기능을 추가하는게 쉬워진다.
- 캡슐화와 은닉
    - 객체 지향에서의 캡슐화를 통해 데이터 은닉을 하는 것처럼 자바스크립트에서도 클로저를 이용해서 데이터를 감출 수 있다.
- 함수, 동작 단위
    - 함수를 추상화해서 특정 동작을 수행하도록 할 수 있다.
- 함수형 프로그래밍이란
    - 함수 형태로 '존재'의 추상화를 정의한다.
    - 기존 함수를 이용해서 '참거짓'의 추상화를 정의한다.
    - 위 함수를  다른 함수의 파라미터로 제공해서 어떤 동작을 하도록 한다.
- 함수형 프로그래밍 특징
    - 추상화를 식별해서 함수로 만든다.
    - 기존 함수를 이용해서 더 복잡한 추상화를 만든다.
    - 기존 함수를 다른 함수에 제공해서 더 복잡한 추상화를 만든다.


## 8. 일급 함수와 응용형 프로그래밍
- 일급 함수의 특징
    - 숫자를 변수에 저장하듯이 함수를 변수에 저장할 수 있다. `var fortytwo = function() { return 42 };`
    - 숫자를 배열에 저장하듯이 함수를 배열에 저장할 수 있다. `var fortytwos = [42, function() { return 42 }];`
    - 숫자를 객체에 저장하듯이 함수를 객체에 저장할 수 있다. `var fortytwos = {number: 42, fun: function() {return 42}};`
    - 언제든 숫자를 만들 수 있듯이 필요할 때 함수를 만들 수 있다. `42 + (function() {return 42})();`
    - 함수에 숫자를 전달할 수 있듯이 함수에 함수를 전달할 수 있다. `function weirdAdd(n, f) {return n + f()}; weirdAdd(42, function(){return 42});`
    - 함수가 숫자를 반환할 수 있듯이 함수가 함수를 반환할 수 있다. `return 42; return function() {return 42};`
    - 위의 마지막 두가지 정의를 사용하는 함수를 '고차원(high-order)' 함수라고 부른다. 이는 함수를 인자로 받거나 결과로 함수를 반환하는 함수를 의미한다.
- 자바스크립트의 다중 패러다임
    - 명령형 프로그래밍: 동작을 자세히 설명하는 방식에 기반한 프로그래밍
    - 프로토타입 기반 객체 지향 프로그래밍: 프로토타입형 객체와 인스턴스에 기반한 프로그래밍
    - 메타프로그래밍: 자바스크립트 실행 모델의 기반을 변경하는 프로그래밍
- 응용형 프로그래밍
    - 컬렉션 중심 프로그래밍의 핵심: 컬렉션을 처리하는 일반적인 처리 방법을 만들어서 재사용할 수 있는 포괄적인 함수 집합을 구축하는 것


## 9. 변수 스코프와 클로저
- '스코프'라는 단어의 다양한 의미
    - this 바인딩값
    - this 바인딩값이 정의하는 실행 컨텍스트
    - 변수 '생명주기'
    - 변숫값 해석 방식 또는 어휘적 바인딩
- 전역 스코프 global scope
    - 스코프의 범위(extent)라는 말은 변수의 생명주기(lifetime)를 의미한다.
    - 전역 변수는 생명주기가 가장 길다. `var` 키워드 없이 정의된 변수는 전역 스코프다.
    - 자바스크립트에서 변수는 불변성을 가질 수 없다. 고로 어디서든 수정이 가능하다는 문제가 존재한다. (무질서)
- 어휘 스코프 lexical scope
    - 어휘 스코프란 __변수와 값의__ 유효 범위를 가리킨다.
    - 변수 탐색은 가장 내부 스코프에서 외부로 진행된다. 변수 탐색 과정에서 먼저 발견된 변수까지 어휘 스코프가 결정된다.
- 동적 스코프 dynamic scope
    - 바인딩 이름과 관련한 전역 맵 스택을 유지하는 것이 동적 스코핑의 핵심이다.
