# Regular Expression(정규 표현식)
_from Secrets of the JavaScript Ninja_

## 1. 정규 표현식이란?
- 텍스트 내에서 일치하는 문자열을 찾기 위해 문장열의 패턴을 표현하는 방식이다.
- 패턴을 정의할 수 있도록 하는 용어(terms)와 연산자(operators)로 구성되어 있다.
- 자바스크립트에서 정규 표현식을 생성하기 위해서는 리터럴을 이용하거나 RegExp 생성자를 이용할 수 있다. (어떤 정규 표현식을 이용할지 알고 있는 경우에는 리터럴, 실행 중에 동적으로 정규 표현식을 생성하는 경우는 생성자를 이용한다.)
```javascript
var pattern = /test/;   // 정규 표현식 리터럴
var pattern = new RegExp("test");   // 정규 표현식 생성자
```


## 2. 플래그
- 정규 표현식과 함께 사용되는 옵션값
    1. `i`: 정규 표현식이 대소문자를 구별하지 않도록 한다.
    2. `g`: 맨 처음 나타나는 부분과 단 한 번만 매치시키는, 기본 설정인 local과 반대로 지정된 패턴에 해당하는 모든 부분을 매치시킨다.
    3. `m`: 여러 줄을 포함하고 있는 문자열을 대상으로 매치할 수 있게 해준다.


## 3. 용어(terms)와 연산자(operators)
- 정확히 같은 부분 매칭하기
  - `/test/`와 같이 역슬래시 안에 특별한 처리 없이 문자를 나열하는 것은 문자열을 놓은 순서대로 그대로 매치한다.
- 문자 클래스를 이용해서 매칭하기
  - `/[abc]/`와 같이 집합 연산자(혹은 문자 클래스 연산자)인 \[\](대괄호)로 묶어서 표현하면 대괄호 안의 문자를 포함하는 모든 문자를 매치한다.
  - `/[^abc]/`여기서 ^(캐럿)은 역집합의 의미다. abc를 제외한 문자들을 매치한다.
  - `/[a-k]/`여기서 -(대시)는 범위를 표현한다. a부터 k까지의 문자들을 매치한다. (`/[abcdefghijk]/`와 같은 의미다.)
- 이스케이핑
  - 대시, 캐럿, 대괄호와 같은 특수 문자(연산자)를 포함하는 문자열을 매치하고 싶은 경우엔 \\(역슬래시)를 사용하여 이스케이프 시켜준다.
- 시작과 끝
  - 캐럿(^) 문자는 정규 표현식의 첫 번째 문자로 사용되었을 때 문자열의 시작과 매치가 된다. 시작점 외에 위치한 문자열은 무시한다.
  - 달러($) 문자는 정규 표현식의 마지막 문자로 사용되었을 때 문자열의 끝과 매치가 된다. 끝지점 외에 위치한 문자열은 무시한다.
  - `/^test$/`이와 같이 두개를 동시에 사용하면 test라는 문자열이 비교대상 문자열의 전체와 일치해야 매치가 된다.
- 반복된 출현
  - ?(물음표)를 문자 뒤에 두면 문자가 있거나 없는 경우를 지정할 수 있다. (0 ~ 1회) __물음표는 다른 연산자와 함게 사용되어 최소한으로 일치하는 부분을 매치하도록 만드는 용도로도 사용된다.__ (플래그가 g가 아닌 경우)
  - +(더하기)를 문자 뒤에 두면 문자가 한번 이상 나타나는 경우를 지정할 수 있다. (1회 이상)
  - \*(곱하기)를 문자 뒤에 두면 문자가 한번도 나타나지 않거나 한번 이상 나타나는 것을 지정할 수 있다. (0회 이상)
  - {}(중괄호) 사이에  반복 횟수를 지정하고 문자 뒤에 두면 정해진 횟수만큼 반복되는 경우를 지정할 수 있다.
      - ,(콤마)를 구분자로 반복 횟수에 구간을 지정할 수 있다. `/a{3,10}/`은 a가 3~10번 연속으로 나오는 것과 매치가 된다. 콤마 뒤의 두 번째 값은 생략할 수 있는데 이는 앞의 숫자 이상의 값을 지정할 때 사용된다.
- 미리 정의된 문자 클래스
  - 문자 중에 개행 문자 같은 제어용 문자들은 정규 표현식으로 지정하기 어렵다. 이러한 문자 집합은 미리 정의한 용어 형태로 접근이 가능하다.

| 미리 정의된 용어 | 대상 |
| :--- | :--- |
| `\t` | 수평탭 |
| `\b` | 백스페이스 |
| `\v` | 수직탭 |
| `\f` | 폼피드 |
| `\r` | 개행 문자 |
| `\ㅜn` | 줄바꿈 문자 |
| `\cA` : `\cZ` | 제어문자 |
| `\x0000` : `\xFFFF` | 유니코드 16진수 |
| `\x00` : `\xFF` | 아스키 16진수 |
| `.` | 줄바꿈 문자(\ㅜㅜn)를 제외한 모든 문자 |
| `\d` | 0-9 사이의 10진수 숫자. [0-9]와 같다. |
| `\D` | 0-9 사이의 10진수 숫자에 속하지 않은 모든 문자. [^0-9]와 같다. |
| `\w` | _를 포함한 모든 영어 알파벳과 숫자. [A-Za-z0-9_]와 같다. |
| `\W` | _를 포함한 모든 영어 알파벳과 숫자가 아닌 모든 문자. [^A-Za-z0-9_]와 같다. |
| `\s` | 공백문자(공백,탭,폼피드 등) |
| `\S` | 공백문자를 제외한 문자 |
| `\b` | 단어의 경계를 나타내는 문자 |
| `\B` | 단어 내에서 문자의 경계가 아닌 문자 |

- 그룹화
  - 만약 용어들로 이뤄진 그룹에 연산자를 적용하고자 한다면, 괄호를 이용할 수 있다. `/(ab)+/`는 'ab'가 1번 이상 나타나는 것을 매치한다.
- 선택(or)
  - | 문자를 이용해서 선택을 표현할 수 있다. `/a|b/`는 'a'나 'b'에 매치된다.
- 역참조
  - 역슬래시 뒤에 참조할 캡처의 번호를 쓰는 방법으로 표현하는 역참조는 `\1`, `\2` 등으로 표현된다. `/<(\w+)>(.+)<\/\/1>/`와 같은 표현식을 사용하면 html에서 `<strong>hello</strong>`와 같은 간단한 엘리면트를 매치할 수 있다.


## 4. 정규 표현식 컴파일하기
- 정규 표현식은 여러 단계의 처리과정을 거친다. 주요 단계는 '컴파일(compilation)'과 '실행(execution)'이다.
  - 정규 표현식이 처음에 만들어지면 컴파일이 일어난다. __컴파일은 찾고자하는 패턴을 만드는 일이다.__ __실행은 컴파일된 정규 표현식으로 문자열 내의 패턴을 찾아내는 일련의 활동이다.__
  - 컴파일 과정에서 자바스크립트 엔진은 정규 표현식을 분석(parse)하고, 정규 표현식은 (어떤 형태로든지)내부적인 표현방식으로 변환이 된다.
  - 이와 같이 정규 표현식을 분석하고 변환하는 단계는 정규 표현식이 만들어질 때마다 항상 일어난다.
- 일반적으로 브라우저들은 같은 정규 표현식이 사용되고 있을 때 이를 알아차리고, 해당 표현식들의 컴파일 결과를 캐시해 둔다.
- 나중에 사용할 정규 표현식을 미리 정의해 두고 미리 컴파일되게 해두면, 상당한 속도 향상을 얻을 수 있다.


## 5. 매치되는 부분을 캡처하기
- 정규 표현식 내에서 괄호로 묶어서 정의하는 부분이 캡처가 되는 부분이다.
- `string.match()` 메서드를 사용하면 배열을 반환하는데, 첫번째 요소로 매치된 전체 부분을 반환하고 두번째 이후로는 캡처된 그룹을 순서대로 배열의 요소로 반환한다.
- 괄호는 용어를 묶고, 캡처를 지정하는 역할을 하는데 경우에 따라 묶는 역할만을 감당하게 만들고 싶을 때가 있다. 이때는 여는 괄호 뒤에 `?:`를 넣어서 캡처를 생성하지 않도록 할 수 있다.


## 예제
_from FreeCodeCamp_
- 예제 01

```javascript
// Setup
var testString = "Ada Lovelace and Charles Babbage designed the first computer and the software that would have run on it.";

// Example
var expressionToGetSoftware = /software/gi;
var softwareCount = testString.match(expressionToGetSoftware).length;

var expression = /and/gi;  // Change this Line

// This code counts the matches of expression in testString
var andCount = testString.match(expression).length;
```
변수 `expression`에서 `/`는 정규표현식의 시작을 나타낸다. 그 이후부터 다음 `/`까지의 문자를 찾는다. 이때 `g`는 전역을 의미하고, `i`는 대소문자 구분을 무시하라는 의미이다. 해당 예제는 `testString`에 포함된 and의 개수를 `andCount`에 반환한다.


- 예제 02

```javascript
// Setup
var testString = "There are 3 cats but 4 dogs.";

var expression = /\d+/g;  // Change this line

// This code counts the matches of expression in testString
var digitCount = testString.match(expression).length;
```
변수 `expression`에서 `\d`는 숫자를 찾는 정규표현식이다. 해당 문자 뒤에 붙은 `+`는 한 단어에서 하나 이상의 숫자를 찾으라는 의미이다. 이때 `g`는 전역을 의미한다. 결과갑으로 `digitCount`에 저장되는 값은 2이다.


- 예제 03

```javascript
// Setup
var testString = "How many spaces are there in this sentence?";

var expression = /\s+/g;  // Change this line

// This code counts the matches of expression in testString
var spaceCount = testString.match(expression).length;
```
변수 `expression`에서 `\s`는 여백(whitespace)을 찾는 정규표현식이다. 이때 여백이란 단순한 공백인 `" "`, 캐리지리턴 `\r`, 뉴라인 `\n`, 탭 `\t`, 그리고 폼피드 `\f`를 의미한다. 마찬가지로 `+`는 하나 이상의 여백을 찾으라는 의미가 된다. 결과값으로 `spaceCount`에 저장되는 값은 7이다. *캐리지리턴과 뉴라인은 같은 기능을 하는데 전자의 경우 IE에서만 동작하고 그 외에 브라우저에서는 동작하지 않는다. 그외에 브라우저에서는 후자를 사용한다.*

이때 `\s`를 대문자 `\S`로 표기하면 반대의 의미가 된다. 즉, 여백이 아닌 문자열을 찾는 정규표현식이 된다. 결과적으로 모든 문자의 수를 확인할 수 있다. *만약에 `\S+`로 표기하면 한 단어에서 한번씩만 문자열을 찾기 때문에 예제 03의 경우 결과값으로 8이 반환된다.*
